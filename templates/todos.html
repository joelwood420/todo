{% extends 'base.html' %}
{% block title %}Your Todos{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Your Todos</h1>
    <a class="btn btn-primary" href="{{ url_for('new_todo') }}">New Todo</a>
  </div>

  {% if todos and todos.items %}
    <div class="list-group">
      {% for t in todos.items %}
        <div class="list-group-item">
          <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{ t.title }}</h5>
            <small>{{ t.created_at.strftime('%Y-%m-%d') if t.created_at else '' }}</small>
          </div>
          <p class="mb-1">{{ t.description }}</p>
          <div class="d-flex justify-content-between align-items-center">
            <small>Completed: {{ 'Yes' if t.completed else 'No' }}</small>
            <div>
              <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('edit_todo', todo_id=t.id) }}">Edit</a>
              <form method="post" action="{{ url_for('delete_todo', todo_id=t.id) }}" style="display:inline-block;" onsubmit="return confirm('Delete this todo?');">
                <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <nav aria-label="Page navigation" class="mt-3">
      <ul class="pagination">
        {% if todos.has_prev %}
          <li class="page-item"><a class="page-link" href="{{ url_for('todos', page=todos.prev_num) }}">Previous</a></li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">Previous</span></li>
        {% endif %}
        <li class="page-item disabled"><span class="page-link">Page {{ todos.page }} of {{ todos.pages }}</span></li>
        {% if todos.has_next %}
          <li class="page-item"><a class="page-link" href="{{ url_for('todos', page=todos.next_num) }}">Next</a></li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">Next</span></li>
        {% endif %}
      </ul>
    </nav>
  {% else %}
    <p class="text-muted">No todos yet.</p>
  {% endif %}
{% endblock %}
